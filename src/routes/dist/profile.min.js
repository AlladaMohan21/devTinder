"use strict";var express=require("express"),profileRouter=express.Router(),_require=require("../middlewares/auth"),userAuth=_require.userAuth,_require2=require("../utils/validation"),validateEditProfileData=_require2.validateEditProfileData,bcrypt=require("bcrypt");profileRouter.get("/profile/view",userAuth,function(r,t){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:try{s=r.user,t.send(s)}catch(e){t.status(400).send("Something went wrong ")}case 1:case"end":return e.stop()}})}),profileRouter.patch("/profile/edit",userAuth,function(r,t){var s;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,validateEditProfileData(r)){e.next=3;break}throw new Error("invalid Edit Request");case 3:return s=r.user,Object.keys(r.body).forEach(function(e){return s[e]=r.body[e]}),e.next=7,regeneratorRuntime.awrap(s.save());case 7:t.json({message:"".concat(s.firstName,",Your profile updated successfully"),data:s}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t.status(400).send("ERROR: "+e.t0.message);case 13:case"end":return e.stop()}},null,null,[[0,10]])}),profileRouter.patch("/profile/forgotpassword",userAuth,function(r,t){var s,a,n;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s=r.body.password,a=r.user,e.next=5,regeneratorRuntime.awrap(bcrypt.hash(s,10));case 5:return n=e.sent,console.log(n),a.password=n,e.next=10,regeneratorRuntime.awrap(a.save());case 10:t.send("Password updated successfully"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),t.status(400).send("ERROR: "+e.t0.message);case 16:case"end":return e.stop()}},null,null,[[0,13]])}),module.exports=profileRouter;
//# sourceMappingURL=profile.min.js.map
