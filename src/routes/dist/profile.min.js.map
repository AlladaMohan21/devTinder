{"version":3,"sources":["profile.js"],"names":["express","require","profileRouter","Router","validateEditProfileData","get","userAuth","req","res","userId","regeneratorRuntime","async","_context","prev","next","send","bcrypt","status","stop","patch","loggedInUser","_context2","Error","Object","keys","body","forEach","key","awrap","save","json","message","concat","firstName","data","t0","password","hashedPassword","_context3","user","sent","console","log","module","exports"],"mappings":"aAAA,IAAMA,QAAQC,QAAQ,WAChBC,cAAcF,QAAQG,kBADdF,QAAQ,uBAAhBD,kBAAAA,mBAG0BC,QAAQ,uBAAjCG,kCAAAA,wBAFDF,OAAAA,QAAcF,UAOpBE,cAAcG,IAAI,gBAAgBC,SAAS,SAAOC,EAAIC,GAAX,IAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAC3C,IANOV,EAAAA,EAAAA,KAQPI,EAAIO,KAAKN,GAPT,MAAMO,GASFR,EAAIS,OAAO,KAAKF,KAAK,yBALkB,KAAA,EAAA,IAAA,MAAA,OAAAH,EAAAM,YAAAhB,cAAAiB,MAAA,gBAAAb,SAAA,SAAAC,EAAAC,GAAA,IAAAY,EAAA,OAAAV,mBAAAC,MAAA,SAAAU,GAAA,OAAA,OAAAA,EAAAR,KAAAQ,EAAAP,MAAA,KAAA,EAAA,GAAAO,EAAAR,KAAA,EAC3CT,wBAAGG,GADwC,CAAAc,EAAAP,KAAA,EAAA,MAAA,MAErCL,IADHa,MACa,wBAF2B,KAAA,EAAA,OAKvCd,EAAWD,EAAKQ,KAapBQ,OAAOC,KAAKjB,EAAIkB,MAAMC,QAAQ,SAACC,GAAD,OAAQP,EAAaO,GAAKpB,EAAIkB,KAAKE,KAlBtBN,EAAAP,KAAA,EAAAJ,mBAAAkB,MAAAR,EAAAS,QAAA,KAAA,EAAArB,EAAAsB,KAAA,CAAAC,QAAA,GAAAC,OAAAZ,EAAAa,UAAA,sCAAAC,KAAAd,IAAAC,EAAAP,KAAA,GAAA,MAAA,KAAA,GAAAO,EAAAR,KAAA,GAAAQ,EAAAc,GAAAd,EAAA,MAAA,GAAAb,EAAAS,OAAA,KAAAF,KAAA,UAAAM,EAAAc,GAAAJ,SAAA,KAAA,GAAA,IAAA,MAAA,OAAAV,EAAAH,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QASEhB,cAAAiB,MAAA,0BAAAb,SAAA,SAAAC,EAAAC,GAAA,IAAA4B,EAAAhB,EAAAiB,EAAA,OAAA3B,mBAAAC,MAAA,SAAA2B,GAAA,OAAA,OAAAA,EAAAzB,KAAAyB,EAAAxB,MAAA,KAAA,EAAA,OAAAwB,EAAAzB,KAAA,EAAAuB,EAAA7B,EAAAkB,KAAAW,SAAAhB,EAAAb,EAAAgC,KAAAD,EAAAxB,KAAA,EAAAJ,mBAAAkB,MAGpCxB,OAAwBG,KAHY6B,EAAA,KAAA,KAAA,EAAA,OAAAC,EAAAC,EAAAE,KAAAC,QAAAC,IAAAL,GAAAjB,EAAAgB,SAAAC,EAAAC,EAAAxB,KAAA,GAAAJ,mBAAAkB,MA6BnCR,EAAaS,QA7BsB,KAAA,GA+BzCrB,EAAIO,KAAK,iCA/BgCuB,EAAAxB,KAAA,GAAA,MAAA,KAAA,GAAAwB,EAAAzB,KAAA,GAAAyB,EAAAH,GAAAG,EAAA,MAAA,GAOlClB,EAAAA,OAAAA,KAAAA,KAAab,UAPqB+B,EAAAH,GAAAJ,SAAA,KAAA,GAAA,IAAA,MAAA,OAAAO,EAAApB,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,QAAAyB,OAAAC,QAAA1C","file":"profile.min.js","sourcesContent":["const express=require(\"express\");\r\nconst profileRouter=express.Router();\r\nconst{userAuth}=require(\"../middlewares/auth\")\r\nconst {validateEditProfileData}=require(\"../utils/validation\")\r\nconst bcrypt = require(\"bcrypt\");\r\n\r\n\r\n\r\nprofileRouter.get(\"/profile/view\",userAuth,async (req,res)=>{\r\ntry{\r\nconst userId=req.user; \r\nres.send(userId);\r\n}catch (err) {\r\n    res.status(400).send(\"Something went wrong \");\r\n  }\r\n})\r\n\r\nprofileRouter.patch(\"/profile/edit\",userAuth,async (req,res)=>{\r\n    try{\r\n\r\n     if(!validateEditProfileData(req))   {\r\n        throw new Error(\"invalid Edit Request\");\r\n     }\r\n\r\n     const loggedInUser=req.user;\r\n\r\nObject.keys(req.body).forEach((key)=>(loggedInUser[key]=req.body[key]));\r\nawait loggedInUser.save();\r\n\r\nres.json({message:`${loggedInUser.firstName},Your profile updated successfully`,\r\ndata:loggedInUser})\r\n    }catch(err){\r\nres.status(400).send(\"ERROR: \"+ err.message);\r\n    }\r\n})\r\n\r\nprofileRouter.patch(\"/profile/forgotpassword\", userAuth, async (req, res) => {\r\n  try {\r\n    const { password } = req.body;\r\n    const loggedInUser = req.user;\r\n\r\n    // hash the new password\r\n    const hashedPassword = await bcrypt.hash(password, 10);\r\n    console.log(hashedPassword)\r\n\r\n    loggedInUser.password = hashedPassword;\r\n    await loggedInUser.save();\r\n\r\n    res.send(\"Password updated successfully\");\r\n  } catch (err) {\r\n    res.status(400).send(\"ERROR: \" + err.message);\r\n  }\r\n});\r\n\r\nmodule.exports=profileRouter"]}